#!/usr/bin/env bash
#
# Default pre-commit hook

# Check if pre-commit needs to be installed
if [[ -f .pre-commit-config.yaml ]]; then
  # Example signature:
  #!/usr/bin/bash
  # File generated by pre-commit: https://pre-commit.com
  # ID: 138fd403232d2ddd5efb44317e38bf03
  PRE_COMMIT_HEADER_SIGNATURE="File generated by pre-commit: https://pre-commit.com"
  PRE_COMMIT_HEADER_SIZE=3 # Lines

  # ANSI color/style codes
  YELLOW='\033[33m'
  BOLD='\033[1m'
  DIM='\033[2m'
  RESET='\033[0m'
  if ! head -n "${PRE_COMMIT_HEADER_SIZE}" .git/hooks/pre-commit 2>/dev/null | grep --quiet "${PRE_COMMIT_HEADER_SIGNATURE}"; then
    echo >&2
    echo -e "${YELLOW}⚠️ This repository uses pre-commit, but the hook is not installed.${RESET}" >&2
    echo -e "${YELLOW}   Run ${BOLD}pre-commit install${RESET}${YELLOW} to activate it.${RESET}" >&2
    echo -e "${DIM}   (To bypass this hook, commit with ${BOLD}git commit --no-verify${RESET}${DIM} option)${RESET}" >&2
    echo >&2
    exit 1
  fi
fi
